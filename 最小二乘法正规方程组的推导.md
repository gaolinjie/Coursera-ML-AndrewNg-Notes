### 最小二乘法正规方程组的推导

#### 1. 符号说明

$m$: 样本数量

$n$: 特征数量

$\theta$: 回归系数，是$n\times 1$向量

$J(\theta)$: 代价函数

$x_i$: 输入变量，是向量

$y_i$: 因变量真实值，是实数

$X$:$m\times n$的矩阵

$Y$:$m\times 1$的向量

$h_\theta (x)$: 假设函数

#### 2. 矩阵的迹

- 定义
$$
tr\ A=\sum^n_{i=1}A_{ii}
$$

- $a=tr\ a\ (a\in \mathbb{R})$

  证明：可将实数$a$视为$1\times 1$矩阵。

- $tr\ AB=tr\ BA$

 $tr\ ABC=tr\ CAB=tr\ BCA$

  证明：假设$A$是$n\times m$矩阵，$B$是$m\times n$矩阵，则

$$
tr\ AB=\sum_{i=1}^n\sum_{j=1}^m A_{ij}B_{ji}=\sum_{j=1}^n\sum_{i=1}^m B_{ji}A_{ij}=tr\ BA
$$

- $\nabla_Atr\ AB=\nabla_Atr\ BA=B^T$

  证明：先给出以矩阵为变元的标量函数关于矩阵求梯度所得的梯度矩阵的定义。

  其中$X$是矩阵，$f$是以矩阵为变元的标量函数。

$$
\nabla_Xf(X)=\left[\begin{matrix}
\frac{\partial f(X)}{\partial x_{11}} & \cdots & \frac{\partial f(X)}{\partial x_{1n}} \\
\vdots & \ddots & \vdots \\
\frac{\partial f(X)}{\partial x_{m1}} & \cdots & \frac{\partial f(X)}{\partial x_{mn}} \\
\end{matrix}
\right]=\frac{\partial f(X)}{\partial X}
$$

​	假设$A$是$n\times m$矩阵，$B$是$m\times n$矩阵，则
$$
\begin{aligned}
\nabla_Atr\ BA &= \nabla_A\sum_{i=1}^m\sum_{j=1}^n B_{ij}A_{ji}=\frac{\partial}{\partial A}\left(\sum_{i=1}^m\sum_{j=1}^n B_{ij}A_{ji}\right) \\
& = \left[\begin{matrix}
\frac{\partial}{\partial A_{11}}\left(\sum\limits_{i=1}^m\sum\limits_{j=1}^n B_{ij}A_{ji}\right) & \cdots & \frac{\partial}{\partial A_{1m}}\left(\sum\limits_{i=1}^m\sum\limits_{j=1}^n B_{ij}A_{ji}\right) \\
\vdots & \ddots & \vdots \\
\frac{\partial}{\partial A_{n1}}\left(\sum\limits_{i=1}^m\sum\limits_{j=1}^n B_{ij}A_{ji}\right) & \cdots & \frac{\partial}{\partial A_{nm}}\left(\sum\limits_{i=1}^m\sum\limits_{j=1}^n B_{ij}A_{ji}\right)
\end{matrix}    
\right] \\
& = \left[\begin{matrix}
B_{11} & \cdots & B_{m1} \\
\vdots & \ddots & \vdots \\
B_{1n} & \cdots & B_{mn} \\
\end{matrix}    
\right] = B^T
\end{aligned}
$$
​	即$\nabla_Atr\ BA=B^T$

​	根据矩阵的迹的性质，有$\nabla_Atr\ AB=\nabla_Atr\ BA=B^T$

- $\nabla_A\tau a=(\nabla_A a)^T\ (a\in \mathbb{R})$

  证明：由梯度矩阵的定义可证，实数关于矩阵$A_T$的梯度矩阵等于实数关于$A$的梯度矩阵的转置。

- $d(tr\ U)=tr\ (dU)$

  证明：

$$
d(tr\ U)=d\left(\sum_{i=1}^n u_{ii}\right)=\sum_{i=1}^n du_{ii}=tr\ (dU)
$$

​	矩阵的迹的微分等于矩阵的微分的迹

- $\nabla_A tr\ ABA^T C=CAB+C^T AB^T$

  证明：根据性质$d(tr\ U)=tr\ (dU)$，将$AB$视为一个矩阵，由求梯度的乘法法则得

  $\nabla_Atr\ ABA^TC=\nabla_{A_1}tr\ A_1BA^TC+\nabla_{A_2}tr\ ABA_2^TC$ 

  
